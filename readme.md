this code is heavily generated with chatgpt and gemini ai